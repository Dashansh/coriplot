---
title: "cori-theme-vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{cori-theme-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  warning = FALSE,
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

## Import Libraries, Load Data

Load the required libraries to run the code.

```{r imports}
library(ggplot2)
library(dplyr)
library(coriplot)
library(tidyr)

data("remote_work_by_ed_level")
data("time_series_sample_data")

```


This applied the theme designed specifically for CORI and sets the defaults.
```{r set_theme}
theme_set(theme_cori())
set_cori_geom_defaults()
```

## Single Line Chart Example

```{r chart1}

# Extract the 2021 data
remote_work_by_ed_level %>%
  subset(date > "2020-12-31" & date < "2022-01-01") %>% 
  mutate(education_level = factor(education_level)) -> temp

temp$education_level <- recode_factor(temp$education_level,
                      bachelors_or_higher = "Bachelors or higher",
                      high_school_no_college = "High School and no College",
                      less_than_high_school = "Less than High School",
                      some_college_or_associates = "Some College or Associates")

# For Single line chart, let's focus on Bachelors or Higher Education level
temp %>%
  filter(education_level == "Bachelors or higher") %>% 
  ggplot(aes(as.Date(date),
        pct_working_remotely)) +
  geom_line() +
  geom_point() +
  scale_x_date(date_breaks = "1 month", date_labels =  "%b") +
  scale_y_continuous(limits = c(NA, 0.51)) +
  labs(
    title = "People with Education level Bachelors or higher\nTrend of working remotely throughout 2021",
    subtitle = "Subtitle goes here. Lorem ipsum dolor sit amet\nconsectetur adipiscing elit.",
    caption = "Source: source goes here https://www.blah.com") +
  xlab("2021") +
  ylab("Percentage %") +
  scale_color_cori() +
  theme_cori()
```

## Example 1

```{r example1}

fig <- remote_work_by_ed_level %>%
  ggplot(aes(as.Date(date),
             pct_working_remotely,
             group = education_level,
             color = education_level)) +
  geom_line(lwd = 1.5) +
  xlab("Some Time") +
  ylab("YLabel") +
  labs(title = "This should not exceed\nMore than two lines",
       subtitle = "Some random subtitle",
       caption = "This image is not mine") +
  scale_x_date(date_breaks = "1 month", date_labels =  "%b") + 
  scale_y_continuous(expand = c(0, 0), limits = c(0,NA)) +
  theme_cori()+
  scale_y_percent()

fig

```



```{r example3}

twoColDf<-time_series_sample_data[,c("date","less_than_high_school","high_school_no_college")]
colnames(twoColDf)<-c("date","urban","rural")
df2col<- tidyr::pivot_longer(
  twoColDf,
  cols = !date,
  names_to = "education_level",
  values_to = "pct_working_remotely"
)

fig <- df2col %>%
  ggplot(aes(as.Date(date), pct_working_remotely, group = education_level, color = education_level)) +
  geom_line(lwd = 1.5) +
  xlab("") +
  scale_x_date(date_breaks = "1 month", date_labels =  "%b") + 
  scale_y_continuous(expand = c(0, 0)) +
  geom_point(size = 2)+
  ggtitle("Line Chart - straight lines") +
  labs(subtitle = "Only 2 Columns")+
  ylab("Percentage Working Remotely")+
  scale_color_cori(cori_primary) 
fig 
```


This is a basic example which shows you how to make curved lines:

```{r example4}

fig <- remote_work_by_ed_level[1:20,] %>%
  ggplot(aes(as.Date(date),
             pct_working_remotely,
             group = education_level,
             color = education_level)) +
  geom_smooth(method = 'loess',
              linetype = 1,
              size = 1,
              lwd = 1.5,
              se= FALSE) +
  xlab("") +
  scale_x_date(date_breaks = "1 month", date_labels =  "%b") + 
  scale_y_continuous(expand = c(0, 0)) +
  geom_point(size = 2)+
  ggtitle("Line Chart - Curved lines")+
  labs(subtitle = "Multiple Colors")+
  scale_color_cori(cori_primary) 

fig
```


```{r example5}

d <- data.frame(a=c(1,2,3,4,1,2,3,4),b=c(1,1,1,1,2,2,2,2),c=c(4,6,5,7,8,3,5,6))
d$b<-as.factor(d$b)

shift<-0
f<-ggplot(data=d,aes(x=a, y=c, group=b, color=b))+
  geom_line()+
  theme_cori()+
  scale_color_cori()

threshold(f,3.5, axis="x", label="\nthreshold",shift=0.15)
```

## New 

```{r example6}


twoColDf_defaults <- time_series_sample_data[,c("date","less_than_high_school","high_school_no_college")]

set_cori_geom_defaults()

colnames(twoColDf_defaults)<-c("date","urban","rural")

df2col<- tidyr::pivot_longer(
  twoColDf_defaults,
  cols = !date,
  names_to = "education_level",
  values_to = "pct_working_remotely"
)

fig <- df2col %>%
  ggplot(aes(as.Date(date), pct_working_remotely, group = education_level)) +
  geom_line() +
  geom_point() +
  geom_hline(yintercept = 0.10) +
  xlab("") +
  scale_x_date(date_breaks = "1 month", date_labels =  "%b") +
  ggtitle("Line Chart - straight lines") +
  labs(subtitle = "Only 2 Columns")+
  ylab("Percentage Working Remotely")+
  theme_cori()
  
fig 


```

```{r example7}
remote_work_by_ed_level %>%
    ggplot(
      aes(as.Date(date),
          pct_working_remotely,
          group = education_level,
          color = education_level)) +
    geom_line(lwd = 1.5) +
    geom_point(size = 2) +
    scale_x_date(date_breaks = "1 month", date_labels =  "%b") +
    labs(
      title = "Title of the chart goes here.\nAvoid more than two lines",
      subtitle = "Subtitle goes here. Lorem ipsum dolor sit amet\nconsectetur adipiscing elit.",
      caption = "Source: source goes here https://www.blah.com") +
    xlab("X Axis Title") +
    ylab("Y Axis Title") +
    scale_color_cori() +
    theme_cori() +
    watermark()-> fig

fig
```

```{r example_area_plot}


remote_work_by_ed_level %>%
    ggplot(
      aes(as.Date(date),
          pct_working_remotely,
          group = education_level,
          color = education_level)) +
    geom_line(lwd = 1.5) +
    geom_point(size = 2) +
    scale_x_date(date_breaks = "1 month", date_labels =  "%b") +
    labs(
      title = "Title of the chart goes here.\nAvoid more than two lines",
      subtitle = "Subtitle goes here. Lorem ipsum dolor sit amet\nconsectetur adipiscing elit.",
      caption = "Source: source goes here https://www.blah.com") +
    xlab("X Axis Title") +
    ylab("Y Axis Title") +
    scale_color_cori() +
    theme_cori() -> fig

fig


```
